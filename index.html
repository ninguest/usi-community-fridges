<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Fridges SG</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .mobile-container {
            max-width: 375px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
        }

        /* Status Bar */
        .status-bar {
            height: 44px;
            background: #000;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        /* Navigation */
        .nav-tabs {
            display: flex;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-tab {
            flex: 1;
            padding: 16px;
            text-align: center;
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .nav-tab.active {
            color: #4facfe;
            border-bottom-color: #4facfe;
            background: rgba(79, 172, 254, 0.05);
        }

        /* Content Area */
        .content {
            padding: 0;
            padding-bottom: 80px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Map Section */
        .map-container {
            height: 250px;
            background: linear-gradient(45deg, #e3f2fd, #bbdefb);
            position: relative;
            margin: 0;
            overflow: hidden;
        }

        #leaflet-map {
            height: 100%;
            width: 100%;
        }

        /* Quick Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            padding: 20px;
            background: white;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .stat-number {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Fridge Cards */
        .fridge-list {
            padding: 20px;
            background: #f8f9fa;
        }

        .fridge-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            transition: transform 0.2s ease;
            cursor: pointer;
        }

        .fridge-card:hover {
            transform: translateY(-2px);
        }

        .fridge-header {
            display: flex;
            justify-content: between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .fridge-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            flex: 1;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            margin-left: 10px;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-needs {
            background: #fff3cd;
            color: #856404;
        }

        .fridge-details {
            font-size: 14px;
            color: #666;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        .fridge-distance {
            font-size: 12px;
            color: #4facfe;
            font-weight: 500;
        }

        /* Action Button */
        .floating-action {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(255, 107, 107, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .floating-action:hover {
            transform: scale(1.1);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 375px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }

        .nav-item {
            flex: 1;
            padding: 12px 8px 8px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .nav-item.active {
            color: #4facfe;
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 10px;
            font-weight: 500;
        }

        /* Form Styles */
        .form-section {
            padding: 20px;
            background: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            display: block;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #4facfe;
        }

        .btn-primary {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        /* Analytics Cards */
        .analytics-section {
            padding: 20px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .chart-placeholder {
            height: 200px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 20px;
        }

        .impact-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .impact-card {
            background: white;
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid #4facfe;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .impact-value {
            font-size: 20px;
            font-weight: 700;
            color: #333;
        }

        .impact-label {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }

        .faq-list { margin-top: 20px; }
        .faq-item { margin-bottom: 16px; }
        .faq-question {
            width: 100%;
            background: #f8f9fa;
            border: none;
            padding: 12px 16px;
            font-size: 16px;
            font-weight: 600;
            text-align: left;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .faq-question:hover { background: #e3f2fd; }
        .faq-answer {
            display: none;
            background: #fff;
            padding: 12px 16px;
            border-radius: 8px;
            margin-top: 4px;
            font-size: 15px;
            color: #333;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .faq-item.active .faq-answer { display: block; }

        /* Help Chat Modal */
        #helpChat {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.7);
            z-index: 999;
            align-items: center;
            justify-content: center;
        }

        #helpChat .modal-content {
            background: #fff;
            border-radius: 16px;
            padding: 24px;
            max-width: 340px;
            margin: auto;
            position: relative;
            height: 400px;
            display: flex;
            flex-direction: column;
        }

        #helpChat h2 {
            margin-bottom: 16px;
            font-size: 20px;
        }

        #chatMessages {
            flex: 1;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 15px;
        }

        #chatInput {
            width: 100%;
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            margin-bottom: 8px;
        }

        #chatSend {
            width: 100%;
            padding: 10px;
            border: none;
            background: #4facfe;
            color: #fff;
            border-radius: 8px;
            font-size: 16px;
        }

        #chatClose {
            margin-top: 8px;
            width: 100%;
            padding: 8px;
            border: none;
            background: #ff6b6b;
            color: #fff;
            border-radius: 8px;
            font-size: 15px;
        }

        /* Dark Theme Styles */
        #dark-theme-style {
            /* Default dark theme styles */
            background-color: #121212;
            color: #e0e0e0;
        }

        #dark-theme-style body {
            background-color: #121212;
            color: #e0e0e0;
        }

        #dark-theme-style .mobile-container {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }

        #dark-theme-style .nav-tabs, #dark-theme-style .bottom-nav {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }

        #dark-theme-style .tab-content, #dark-theme-style .form-section, #dark-theme-style .fridge-card, #dark-theme-style .fridge-header, #dark-theme-style .fridge-title, #dark-theme-style .stat-card, #dark-theme-style .impact-card, #dark-theme-style .faq-list, #dark-theme-style .faq-question, #dark-theme-style .faq-answer, #dark-theme-style .faq-item.active .faq-answer {
            background-color: #2c2c2c;
            color: #e0e0e0;
        }

        #dark-theme-style .btn-primary {
            background: linear-gradient(135deg, #0072ff, #00c6ff);
        }

        #dark-theme-style .status-active {
            background: #2d2d2d;
            color: #4caf50;
        }

        #dark-theme-style .status-needs {
            background: #2d2d2d;
            color: #ff9800;
        }

        #dark-theme-style a {
            color: #bbdefb;
        }

        #dark-theme-style h1, #dark-theme-style h2, #dark-theme-style h3, #dark-theme-style h4, #dark-theme-style h5, #dark-theme-style h6 {
            color: #e0e0e0;
        }

        #dark-theme-style .nav-label, #dark-theme-style .nav-icon {
            color: #eee !important;
        }
    </style>
    <style id="dark-theme-style"></style>
</head>
<body>
    <div class="mobile-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <span>9:41</span>
            <span>🔋 100%</span>
        </div>

        <!-- Header -->
        <div class="header">
            <h1>Community Fridges SG</h1>
            <p>Connecting communities through food sharing</p>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs" id="main-tabs">
            <button class="nav-tab active" onclick="showTab('map')">Map</button>
            <button class="nav-tab" onclick="showTab('donate')">Donate</button>
            <button class="nav-tab" onclick="showTab('analytics')">Impact</button>
        </div>

        <!-- Content Area -->
        <div class="content">
            <!-- Map Tab -->
            <div class="tab-content active" id="map-tab">
                <div class="map-container">
                    <div id="leaflet-map" style="height: 250px; width: 100%;"></div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="fridge-count">5</div>
                        <div class="stat-label">Active Fridges</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">1,247</div>
                        <div class="stat-label">Meals Shared</div>
                    </div>
                </div>
                <div class="fridge-list" id="fridge-list"></div>
            </div>

            <!-- Donate Tab -->
            <div class="tab-content" id="donate-tab">
                <div class="form-section">
                    <h2 class="section-title">Donate Food Items</h2>
                    
                    <div class="form-group">
                        <label class="form-label">Select Fridge Location</label>
                        <select class="form-input">
                            <option>Choose nearest fridge...</option>
                            <option>Toa Payoh Hub - 0.3km</option>
                            <option>Ang Mo Kio Community - 1.2km</option>
                            <option>Jurong West Street 42 - 2.1km</option>
                            <option>Bedok North Community - 3.5km</option>
                            <option>Clementi Avenue 2 - 4.2km</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Food Items</label>
                        <textarea class="form-input" rows="3" placeholder="List the items you're donating..."></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Expiry Date</label>
                        <input type="date" class="form-input">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Your Name (Optional)</label>
                        <input type="text" class="form-input" placeholder="Anonymous donor">
                    </div>

                    <button class="btn-primary">Schedule Donation</button>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div class="tab-content" id="analytics-tab">
                <div class="analytics-section">
                    <h2 class="section-title">Community Impact</h2>
                    <canvas id="donationChart" style="height:200px; width:100%; margin-bottom:20px;"></canvas>
                    <div class="impact-grid">
                        <div class="impact-card">
                            <div class="impact-value">12,450</div>
                            <div class="impact-label">Total Meals</div>
                        </div>
                        <div class="impact-card">
                            <div class="impact-value">856</div>
                            <div class="impact-label">Active Donors</div>
                        </div>
                        <div class="impact-card">
                            <div class="impact-value">5</div>
                            <div class="impact-label">Fridges Network</div>
                        </div>
                        <div class="impact-card">
                            <div class="impact-value">15</div>
                            <div class="impact-label">HDB Districts</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Tab -->
            <div class="tab-content" id="faq-tab" style="display:none;">
                <div class="analytics-section">
                    <h2 class="section-title">FAQ & Help</h2>
                    <div class="faq-list">
                        <div class="faq-item">
                            <button class="faq-question" onclick="toggleFAQ(this)">What is a community fridge?</button>
                            <div class="faq-answer">A community fridge is a public refrigerator where anyone can donate or take food, helping reduce food waste and support those in need.</div>
                        </div>
                        <div class="faq-item">
                            <button class="faq-question" onclick="toggleFAQ(this)">How do I donate food?</button>
                            <div class="faq-answer">Go to the Donate tab, select a fridge location, and fill in the details. Please ensure donated food is safe and not expired.</div>
                        </div>
                        <div class="faq-item">
                            <button class="faq-question" onclick="toggleFAQ(this)">Who can take food from the fridge?</button>
                            <div class="faq-answer">Anyone in the community is welcome to take food from the fridge, no questions asked.</div>
                        </div>
                        <div class="faq-item">
                            <button class="faq-question" onclick="toggleFAQ(this)">How do I report an issue?</button>
                            <div class="faq-answer">Use the Profile tab to contact support or report issues with a fridge.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scan QR Tab -->
            <div class="tab-content" id="scanqr-tab" style="display:none;"></div>

            <!-- Notifications Tab -->
            <div class="tab-content" id="notification-tab" style="display:none;"></div>

            <!-- Profile Tab -->
            <div class="tab-content" id="profile-tab" style="display:none;"></div>
        </div>

        <!-- Floating Action Button (Hidden - Not in Used) -->
        <button style="display: none;" class="floating-action" onclick="openAddFridge()">+</button>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <button class="nav-item active">
                <div class="nav-icon">🏠</div>
                <div class="nav-label">Home</div>
            </button>
            <button class="nav-item" onclick="openFAQ()">
                <div class="nav-icon">❓</div>
                <div class="nav-label">FAQ & Help</div>
            </button>
            <button class="nav-item" onclick="scanQRCode()">
                <div class="nav-icon">📷</div>
                <div class="nav-label">Scan QR</div>
            </button>
            <button class="nav-item" onclick="openNotifications()">
                <div class="nav-icon">🔔</div>
                <div class="nav-label">Notifications</div>
            </button>
            <button class="nav-item">
                <div class="nav-icon">👤</div>
                <div class="nav-label">Profile</div>
            </button>
        </div>
    </div>

    <!-- Help Chat Modal -->
    <div id="helpChat" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.7); z-index:999; align-items:center; justify-content:center;">
        <div style="background:#fff; border-radius:16px; padding:24px; max-width:340px; margin:auto; position:relative; height:400px; display:flex; flex-direction:column;">
            <h2 style="margin-bottom:16px; font-size:20px;">Help Center Chat</h2>
            <div id="chatMessages" style="flex:1; overflow-y:auto; background:#f8f9fa; border-radius:8px; padding:10px; margin-bottom:10px; font-size:15px;"></div>
            <input id="chatInput" type="text" placeholder="Type your message..." style="width:100%; padding:8px; border-radius:8px; border:1px solid #e0e0e0; margin-bottom:8px;">
            <button id="chatSend" style="width:100%; padding:10px; border:none; background:#4facfe; color:#fff; border-radius:8px; font-size:16px;">Send</button>
            <button id="chatClose" style="margin-top:8px; width:100%; padding:8px; border:none; background:#ff6b6b; color:#fff; border-radius:8px; font-size:15px;">Close</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/minified/html5-qrcode.min.js"></script>
    <script>
        // Load Leaflet JS
        var leafletScript = document.createElement('script');
        leafletScript.src = 'https://unpkg.com/leaflet/dist/leaflet.js';
        document.head.appendChild(leafletScript);

        let leafletMapInitialized = false;
        var fridges = [
            { name: "Toa Payoh Hub", lat: 1.3321, lng: 103.8498, address: "Block 190 Lorong 6 Toa Payoh", status: "Active", restocked: "2 hours ago", distance: "0.3 km away" },
            { name: "Ang Mo Kio Community", lat: 1.3691, lng: 103.8558, address: "Block 406 Ang Mo Kio Ave 10", status: "Needs Items", restocked: "1 day ago", distance: "1.2 km away" },
            { name: "Jurong West Street 42", lat: 1.3511, lng: 103.7172, address: "Block 420 Jurong West Street 42", status: "Well Stocked", restocked: "Today", distance: "2.1 km away" },
            { name: "Bedok North Community", lat: 1.3331, lng: 103.9271, address: "Block 538 Bedok North Street 3", status: "Low Stock", restocked: "Yesterday", distance: "3.5 km away" },
            { name: "Clementi Avenue 2", lat: 1.3156, lng: 103.7656, address: "Block 312 Clementi Avenue 2", status: "Active", restocked: "Today", distance: "4.2 km away" }
        ];

        function renderFridgeList() {
            var list = document.getElementById('fridge-list');
            list.innerHTML = '';
            fridges.forEach(function(fridge) {
                var statusClass = fridge.status === 'Active' || fridge.status === 'Well Stocked' ? 'status-active' : 'status-needs';
                list.innerHTML += `
                    <div class="fridge-card">
                        <div class="fridge-header">
                            <div class="fridge-title">${fridge.name}</div>
                            <div class="status-badge ${statusClass}">${fridge.status}</div>
                        </div>
                        <div class="fridge-details">
                            ${fridge.address}<br>
                            Last restocked: ${fridge.restocked}
                        </div>
                        <div class="fridge-distance">📍 ${fridge.distance}</div>
                    </div>
                `;
            });
            document.getElementById('fridge-count').textContent = fridges.length;
        }

        function initLeafletMap() {
            if (leafletMapInitialized) return;
            leafletMapInitialized = true;
            var map = L.map('leaflet-map').setView([1.3521, 103.8198], 11); // Singapore
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '© OpenStreetMap'
            }).addTo(map);
            fridges.forEach(function(fridge) {
                L.marker([fridge.lat, fridge.lng])
                    .addTo(map)
                    .bindPopup('<b>' + fridge.name + '</b>');
            });
            renderFridgeList();
        }

        leafletScript.onload = function() {
            // If map tab is active on load, initialize map
            if (document.getElementById('map-tab').classList.contains('active')) {
                setTimeout(initLeafletMap, 100);
            }
        };

        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
                tab.style.display = 'none';
            });
            // Show main tabs only for map/donate/analytics
            if (tabName === 'map' || tabName === 'donate' || tabName === 'analytics') {
                document.getElementById('main-tabs').style.display = 'flex';
            } else {
                document.getElementById('main-tabs').style.display = 'none';
            }
            // Show selected tab content
            document.getElementById(tabName + '-tab').classList.add('active');
            document.getElementById(tabName + '-tab').style.display = 'block';
        }

        function openAddFridge() {
            alert('Add New Fridge Location feature - opens modal/new page');
        }

        function openFAQ() {
            // Switch to FAQ tab
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.getElementById('faq-tab').style.display = 'block';
            document.getElementById('faq-tab').classList.add('active');
            document.getElementById('map-tab').style.display = 'none';
            document.getElementById('donate-tab').style.display = 'none';
            document.getElementById('analytics-tab').style.display = 'none';
        }
        function scanQRCode() {
            document.getElementById('scanqr-tab').style.display = 'block';
            document.getElementById('notification-tab').style.display = 'none';
            document.getElementById('faq-tab').style.display = 'none';
            document.getElementById('map-tab').style.display = 'none';
            document.getElementById('donate-tab').style.display = 'none';
            renderQRCodePage();
        }
        function renderQRCodePage() {
            var scanTab = document.getElementById('scanqr-tab');
            scanTab.innerHTML = `<div style='padding:24px;'><h2>Scan QR Code</h2><div id='qr-reader' style='width:300px;'></div><div id='qr-result' style='margin-top:16px; font-size:15px;'></div></div>`;
            if(window.qrScanner) window.qrScanner.clear();
            window.qrScanner = new Html5Qrcode("qr-reader");
            window.qrScanner.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, qrCodeSuccessCallback);
        }
        function qrCodeSuccessCallback(decodedText, decodedResult) {
            window.qrScanner.stop();
            var resultDiv = document.getElementById('qr-result');
            resultDiv.innerHTML = `<b>Scanned Link:</b> <a href='${decodedText}' target='_blank'>${decodedText}</a>`;
        }
        function openNotifications() {
            document.getElementById('notification-tab').style.display = 'block';
            document.getElementById('scanqr-tab').style.display = 'none';
            document.getElementById('faq-tab').style.display = 'none';
            document.getElementById('map-tab').style.display = 'none';
            document.getElementById('donate-tab').style.display = 'none';
            renderNotificationPage();
        }
        function renderNotificationPage() {
            var notifTab = document.getElementById('notification-tab');
            notifTab.innerHTML = `<div style='padding:24px;'><h2>Notifications</h2><div class='notification-item' style='margin-bottom:12px;'><div style='font-weight:600;'>Fridge restocked!</div><div style='font-size:14px; color:#555;'>Toa Payoh Hub was restocked 2 hours ago.</div></div><div class='notification-item' style='margin-bottom:12px;'><div style='font-weight:600;'>Low stock alert</div><div style='font-size:14px; color:#555;'>Bedok North Community needs donations.</div></div><div class='notification-item' style='margin-bottom:12px;'><div style='font-weight:600;'>New fridge added!</div><div style='font-size:14px; color:#555;'>Clementi Avenue 2 is now open for donations.</div></div></div>`;
        }

        // Add some interactivity to fridge cards
        document.addEventListener('DOMContentLoaded', function() {
            const fridgeCards = document.querySelectorAll('.fridge-card');
            fridgeCards.forEach(card => {
                card.addEventListener('click', function() {
                    const title = this.querySelector('.fridge-title').textContent;
                    alert(`Opening details for: ${title}`);
                });
            });

            // Render donation analytics chart
            var ctx = document.getElementById('donationChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Meals Donated',
                        data: [120, 150, 180, 90, 200, 170, 220],
                        backgroundColor: 'rgba(79,172,254,0.2)',
                        borderColor: 'rgba(79,172,254,1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(79,172,254,1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'Weekly Donation Trend' }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        });

        // Simulate real-time updates
        setInterval(() => {
            const statusBadges = document.querySelectorAll('.status-badge');
            // Could update statuses dynamically here
        }, 30000);

        // Bottom nav handlers
        document.querySelector('.nav-item:nth-child(1)').onclick = function() { showTab('map'); };
        document.querySelector('.nav-item:nth-child(2)').onclick = function() { showTab('faq'); };
        document.querySelector('.nav-item:nth-child(3)').onclick = function() { showTab('scanqr'); renderQRCodePage(); };
        document.querySelector('.nav-item:nth-child(4)').onclick = function() { showTab('notification'); renderNotificationPage(); };
        document.querySelector('.nav-item:nth-child(5)').onclick = function() { showTab('profile'); };
        // Profile full page
        document.getElementById('profile-tab').innerHTML = `
            <div style='padding:24px;'>
                <h2 class='section-title'>Profile</h2>
                <form id='profileForm' style='margin-bottom:24px;'>
                    <div style='margin-bottom:16px;'>
                        <label style='font-weight:600;'>Name</label>
                        <input type='text' id='profileName' value='User Name' style='width:100%; padding:8px; border-radius:8px; border:1px solid #e0e0e0;'>
                    </div>
                    <div style='margin-bottom:16px;'>
                        <label style='font-weight:600;'>Email</label>
                        <input type='email' id='profileEmail' value='user@email.com' style='width:100%; padding:8px; border-radius:8px; border:1px solid #e0e0e0;'>
                    </div>
                    <button type='button' id='updateProfileBtn' style='width:100%; padding:10px; border:none; background:#4facfe; color:#fff; border-radius:8px; font-size:16px;'>Update Profile</button>
                </form>
                <div style='margin-bottom:24px;'>
                    <label style='font-weight:600;'>Language</label>
                    <select id='languageSelect' style='width:100%; padding:8px; border-radius:8px; border:1px solid #e0e0e0; margin-bottom:12px;'>
                        <option value='en'>English</option>
                        <option value='zh'>中文</option>
                        <option value='ms'>Malay</option>
                        <option value='ta'>Tamil</option>
                    </select>
                </div>
                <div style='margin-bottom:24px;'>
                    <label style='font-weight:600;'>Preferences</label>
                    <div style='margin-top:8px;'>
                        <label><input type='checkbox' id='prefNotify' checked> Enable notifications</label><br>
                        <label><input type='checkbox' id='prefDark'> Dark mode</label>
                    </div>
                </div>
                <div style='margin-bottom:24px;'>
                    <button type='button' id='helpCenterBtn' style='width:100%; padding:10px; border:none; background:#e3f2fd; color:#333; border-radius:8px; font-size:15px;'>Help Center</button>
                </div>
                <div style='margin-bottom:24px;'>
                    <button type='button' id='logoutBtn' style='width:100%; padding:10px; border:none; background:#ff6b6b; color:#fff; border-radius:8px; font-size:16px;'>Logout</button>
                </div>
                <div>
                    <button type='button' id='deleteAccountBtn' style='width:100%; padding:10px; border:none; background:#333; color:#fff; border-radius:8px; font-size:16px;'>Delete Account</button>
                </div>
            </div>
        `;
        // Profile actions
        document.getElementById('updateProfileBtn').onclick = function() {
            alert('Profile updated!');
        };
        document.getElementById('languageSelect').onchange = function() {
            alert('Language changed to ' + this.options[this.selectedIndex].text);
        };
        document.getElementById('prefNotify').onchange = function() {
            alert('Notifications ' + (this.checked ? 'enabled' : 'disabled'));
        };
        document.getElementById('prefDark').onchange = function() {
            alert('Dark mode ' + (this.checked ? 'enabled' : 'disabled'));
        };
        document.getElementById('helpCenterBtn').onclick = function() {
            document.getElementById('helpChat').style.display = 'flex';
            document.getElementById('chatMessages').innerHTML = '<div style="margin-bottom:8px;">👋 Hi! How can we help you today?</div>';
        };
        document.getElementById('chatSend').onclick = function() {
            var input = document.getElementById('chatInput');
            var msg = input.value.trim();
            if(msg) {
                var chat = document.getElementById('chatMessages');
                chat.innerHTML += `<div style='margin-bottom:8px;'><b>You:</b> ${msg}</div>`;
                setTimeout(function(){
                    chat.innerHTML += `<div style='margin-bottom:8px;'><b>Support:</b> Thanks for reaching out! We'll get back to you soon.`;
                }, 700);
                input.value = '';
                chat.scrollTop = chat.scrollHeight;
            }
        };
        document.getElementById('chatClose').onclick = function() {
            document.getElementById('helpChat').style.display = 'none';
        };
        document.getElementById('logoutBtn').onclick = function() {
            if(confirm('Are you sure you want to logout?')) {
                showTab('map');
                alert('Logged out!');
                // redirect to auth.html
                window.location.href = 'auth.html';
            }
        };
        document.getElementById('deleteAccountBtn').onclick = function() {
            if(confirm('Are you sure you want to delete your account? This cannot be undone.')) {
                showTab('map');
                alert('Account deleted!');
                // redirect to auth.html
                window.location.href = 'auth.html';
            }
        };

        // Language translations
        const translations = {
            en: {
                home: "Home",
                faq: "FAQ & Help",
                scanqr: "Scan QR",
                notification: "Notifications",
                profile: "Profile",
                donate: "Donate Food Items",
                impact: "Community Impact",
                fridge: "Fridge",
                mealsShared: "Meals Shared",
                activeFridges: "Active Fridges",
                helpCenter: "Help Center",
                updateProfile: "Update Profile",
                language: "Language",
                preferences: "Preferences",
                logout: "Logout",
                deleteAccount: "Delete Account"
            },
            zh: {
                home: "主页",
                faq: "常见问题与帮助",
                scanqr: "扫描二维码",
                notification: "通知",
                profile: "个人资料",
                donate: "捐赠食物",
                impact: "社区影响",
                fridge: "冰箱",
                mealsShared: "分享的餐食",
                activeFridges: "活跃冰箱",
                helpCenter: "帮助中心",
                updateProfile: "更新资料",
                language: "语言",
                preferences: "偏好设置",
                logout: "登出",
                deleteAccount: "删除账户"
            },
            ms: {
                home: "Laman Utama",
                faq: "Soalan Lazim & Bantuan",
                scanqr: "Imbas QR",
                notification: "Notifikasi",
                profile: "Profil",
                donate: "Derma Makanan",
                impact: "Impak Komuniti",
                fridge: "Petisejuk",
                mealsShared: "Makanan Dikongsi",
                activeFridges: "Petisejuk Aktif",
                helpCenter: "Pusat Bantuan",
                updateProfile: "Kemaskini Profil",
                language: "Bahasa",
                preferences: "Keutamaan",
                logout: "Log Keluar",
                deleteAccount: "Padam Akaun"
            },
            ta: {
                home: "முகப்பு",
                faq: "அடிக்கடி கேட்கப்படும் கேள்விகள் & உதவி",
                scanqr: "QR குறியீட்டை ஸ்கேன் செய்யவும்",
                notification: "அறிவிப்புகள்",
                profile: "சுயவிவரம்",
                donate: "உணவு வழங்கவும்",
                impact: "சமூக தாக்கம்",
                fridge: "குளிர்சாதன பெட்டி",
                mealsShared: "பகிரப்பட்ட உணவுகள்",
                activeFridges: "செயலில் உள்ள குளிர்சாதன பெட்டிகள்",
                helpCenter: "உதவி மையம்",
                updateProfile: "சுயவிவரத்தை புதுப்பிக்கவும்",
                language: "மொழி",
                preferences: "விருப்பங்கள்",
                logout: "வெளியேறு",
                deleteAccount: "கணக்கை நீக்கு"
            }
        };
        function setLanguage(lang) {
            localStorage.setItem('language', lang);
            const t = translations[lang] || translations['en'];
            document.querySelector('.nav-item:nth-child(1) .nav-label').textContent = t.home;
            document.querySelector('.nav-item:nth-child(2) .nav-label').textContent = t.faq;
            document.querySelector('.nav-item:nth-child(3) .nav-label').textContent = t.scanqr;
            document.querySelector('.nav-item:nth-child(4) .nav-label').textContent = t.notification;
            document.querySelector('.nav-item:nth-child(5) .nav-label').textContent = t.profile;
            document.querySelector('.section-title').textContent = t.profile;
            document.getElementById('updateProfileBtn').textContent = t.updateProfile;
            document.getElementById('languageSelect').previousElementSibling.textContent = t.language;
            document.getElementById('helpCenterBtn').textContent = t.helpCenter;
            document.getElementById('logoutBtn').textContent = t.logout;
            document.getElementById('deleteAccountBtn').textContent = t.deleteAccount;
            // Add more UI text updates as needed
        }
        // On language change
        document.getElementById('languageSelect').onchange = function() {
            setLanguage(this.value);
            alert('Language changed to ' + this.options[this.selectedIndex].text);
        };
        // Load language on startup
        document.addEventListener('DOMContentLoaded', function() {
            const lang = localStorage.getItem('language') || 'en';
            setLanguage(lang);
            document.getElementById('languageSelect').value = lang;
        });
        // Preferences: dark mode
        function setDarkMode(enabled) {
            localStorage.setItem('darkMode', enabled ? '1' : '0');
            const style = document.getElementById('dark-theme-style');
            style.textContent = enabled ? `body { background: #222 !important; color: #eee !important; }
    .mobile-container { background: #333 !important; color: #eee !important; }
    .nav-tabs, .bottom-nav { background: #222 !important; color: #eee !important; }
    .nav-label, .nav-icon { color: #eee !important; }
    .tab-content, .form-section, .fridge-card, .fridge-header, .fridge-title, .stat-card, .impact-card, .faq-list, .faq-question, .faq-answer, .faq-item.active .faq-answer, #helpChat .modal-content, #chatMessages, #chatInput, #chatSend, #chatClose { background: #333 !important; color: #eee !important; border-color: #444 !important; }
    button, select, input, textarea { background: #222 !important; color: #eee !important; border-color: #444 !important; }
    h1, h2, h3, .section-title { color: #eee !important; }
    ` : '';
        }
        document.getElementById('prefDark').onchange = function() {
            setDarkMode(this.checked);
            alert('Dark mode ' + (this.checked ? 'enabled' : 'disabled'));
        };
        // Load dark mode on startup
        document.addEventListener('DOMContentLoaded', function() {
            const dark = localStorage.getItem('darkMode') === '1';
            document.getElementById('prefDark').checked = dark;
            setDarkMode(dark);
        });
        // Preferences: notifications
        document.getElementById('prefNotify').onchange = function() {
            localStorage.setItem('notifications', this.checked ? '1' : '0');
            alert('Notifications ' + (this.checked ? 'enabled' : 'disabled'));
        };
        document.addEventListener('DOMContentLoaded', function() {
            const notify = localStorage.getItem('notifications') === '1';
            document.getElementById('prefNotify').checked = notify;
        });

        function toggleFAQ(btn) {
            var item = btn.parentElement;
            item.classList.toggle('active');
            var answer = item.querySelector('.faq-answer');
            if (item.classList.contains('active')) {
                answer.style.display = 'block';
            } else {
                answer.style.display = 'none';
            }
        }
    </script>
</body>
</html>